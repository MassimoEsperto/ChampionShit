<div *ngIf="!loading_page" [hidden]="hidden_page" class="page" style="text-align: center;">

  <div class="pt-8 pb-32 titolo-pagina">
    <h4>{{language.page.personalizza}}</h4>
  </div>

  <div class="mio-container" style="text-align: center;">

    <div class="pb-64">

      <mdb-card>
        <mdb-card-header>{{language.page.cambia_dati}}</mdb-card-header>
        <!--Card content-->
        <mdb-card-body class="pt-16">

          <!-- Form -->
          <form class="text-center" style="color: #757575;" (submit)="onUpdate(loggato)">

            <!-- Username -->
            <div class="pt-32">
            <input type="text" id="username" class="form-control" placeholder="Username" minlength="4"
              maxlength="12" [(ngModel)]="loggato.username" name="username" required #user="ngModel" />
            </div>
            <!-- Email -->
            <div class="pt-32">
            <input type="email" id="email" class="form-control" placeholder="Email" minlength="8" maxlength="25"
              [(ngModel)]="loggato.email" name="email" required email #mail="ngModel" />
            </div>
            <!-- Squadra -->
            <div class="pt-32">
            <input type="text" id="squadra" class="form-control" placeholder="Squadra" minlength="4"
              [(ngModel)]="loggato.squadra" name="squadra" required maxlength="12" #team="ngModel" />
            </div>
            <!-- Sign in button -->
            <div class="pt-64 spazio">
              
            <my-button [submit]="true" [color]="'danger'" [block]="true" 
              [disabled]="mail.invalid||team.invalid||user.invalid" [label]="language.bottoni.invia"
              [loading]="loading_btn">
            </my-button>
          
        </div>
          </form>
          <!-- Form -->

        </mdb-card-body>

      </mdb-card>
    </div>


    <div class="pb-64">
      <mdb-card>
        <mdb-card-header>{{language.page.cambia_img}}</mdb-card-header>
        <!--Card content-->
        <mdb-card-body class="pt-8">

          <div class="image-preview mt-16" *ngIf="avatarSel">
            <img src="assets/avatar/{{avatarSel.nome}}.png" width="220" height="220" />
          </div>
          <div class="image-preview" *ngIf="!avatarSel">
            <img src="assets/img/omino.png" width="220" height="220" />
          </div>
          <br>
          <mat-form-field appearance="outline">
            <mat-label>{{language.bottoni.avatar}}</mat-label>
            <mat-select (selectionChange)="selectedCombo($event.value)">
              <mat-option *ngFor="let item of avatars" [value]="item">
                <img src="assets/avatar/{{item.nome}}.png" width="20" height="20" />
                {{item.nome}}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <my-button [submit]="false" [color]="'danger'" [block]="true" [disabled]="!avatarSel"
            [label]="language.bottoni.invia" [loading]="loading_btn" (myClick)="updateAvatar()"></my-button>

        </mdb-card-body>

      </mdb-card>

    </div>

  </div>


  <div *ngIf="upgrade" class="mio-container pr-16 pl-16" style="text-align: center;">

      <div class="pb-64">
  
        <mdb-card>
          <mdb-card-header>{{language.page.cambia_squadra}}</mdb-card-header>
          <!--Card content-->
          
        <mdb-card-body class="pt-8">

          <div class="step1-2">

              <!-- Form -->
              <form class="text-center" style="color: #757575;" #lega="ngForm" (submit)="onLega(lega.utente)">
                  
                  <div class="step1" *ngIf="stepform==1">
                      <div class="step">
                          <span>{{language.login.step.passo}} 1 {{language.login.step.di}} 3</span>
                      </div>
                      <br>
                      <span>{{language.login.step.lega}}</span>
                      <!-- Lega -->
                      <input type="text" id="nome" class="form-control mb-4 mt-4" placeholder="Lega fantacalcio"
                          [(ngModel)]="lega.nome" name="nome" required />

                      <my-button [submit]="false" [color]="'success'" [block]="true" [disabled]="!lega.nome"
                          [loading]="loading_btn" [label]="language.login.step.successivo"
                          (myClick)="getLega(lega.nome)"></my-button>
                  </div>
                  
                  <div class="step2" *ngIf="stepform==2">
                      <div class="step">
                          <span>{{language.login.step.passo}} 2 {{language.login.step.di}} 3</span>
                          <span (click)="stepform=stepform-1">{{language.login.step.indietro}}</span>
                      </div>
                      <br>
                      <span>{{language.login.step.squadra}}</span>

                      <select class="form-control mb-4 mt-4 custom-select" [(ngModel)]="lega.utente"
                          placeholder="Utenti" name="utente" required>
                          <option *ngFor="let u of fantalega" [ngValue]="u">{{u.team}}</option>
                      </select>

                      <!-- Sign in button -->
                      <my-button [submit]="true" [color]="'success'" [block]="true" [disabled]="lega.invalid"
                          [label]="language.login.step.successivo" [loading]="loading_btn"></my-button>
                  </div>


              </form>
              <!-- Form -->
          </div>

          <div class="step3" style="color: #757575;" *ngIf="stepform==3">
              <div class="step">
                  <span>{{language.login.step.passo}} 3 {{language.login.step.di}} 3</span>
                  <span (click)="stepform=stepform-1">{{language.login.step.indietro}}</span>
              </div>
              <br>
              <span>{{language.login.step.rosa}}</span>
              <mat-selection-list #players>
                  <mat-list-option #item *ngFor="let player of vincolati" [selected]="player.selected"
                      [hidden]="disabledTeam(players,player) && !item.selected" [value]="player">
                      {{player.ruolo}} {{player.nome_calciatore}}
                  </mat-list-option>
              </mat-selection-list>
              <br>
              <div class="pa-8" *ngIf="!loading_btn">
                  <my-button [color]="'success'" [block]="true"
                      [disabled]="players.selectedOptions.selected.length!=25"
                      [label]="language.login.step.successivo" [loading]="loading_btn"
                      (myClick)="conferma(players.selectedOptions.selected)"></my-button>
              </div>
          </div>

      </mdb-card-body>
  
        </mdb-card>

        
      </div>
  
</div>